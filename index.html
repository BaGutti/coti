<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cotización - Biblioteca Virtual | Análisis de Costos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #333;
        background: linear-gradient(135deg, #ff9f9f 0%, #764ba2 100%);
        min-height: 100vh;
        overflow-x: hidden;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
        width: 100%;
      }

      .header {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        text-align: center;
        width: 100%;
      }

      .header h1 {
        color: #2c3e50;
        font-size: 2.5rem;
        margin-bottom: 10px;
        font-weight: 700;
      }

      .header p {
        color: #7f8c8d;
        font-size: 1.2rem;
        margin-bottom: 20px;
      }

      .summary-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
        width: 100%;
      }

      .card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        width: 100%;
      }

      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
      }

      .card h3 {
        color: #2c3e50;
        font-size: 1.1rem;
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .card .value {
        font-size: 2rem;
        font-weight: 700;
        color: #27ae60;
        margin-bottom: 5px;
      }

      .card .label {
        color: #7f8c8d;
        font-size: 0.9rem;
      }

      .chart-section {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
        margin-bottom: 30px;
        width: 100%;
      }

      .chart-container {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        margin-bottom: 30px;
        width: 100%;
        max-width: 100%;
      }

      .chart-container h2 {
        color: #2c3e50;
        margin-bottom: 20px;
        font-size: 1.5rem;
        text-align: center;
      }

      .chart-wrapper {
        position: relative;
        height: 400px;
        margin-bottom: 20px;
        width: 100%;
        max-width: 100%;
      }

      .table-section {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        margin-bottom: 30px;
        width: 100%;
        max-width: 100%;
        overflow: hidden;
      }

      .table-section h2 {
        color: #2c3e50;
        margin-bottom: 20px;
        font-size: 1.5rem;
        text-align: center;
      }

      .table-wrapper {
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        border-radius: 10px;
        max-width: 100%;
      }

      table {
        width: 100%;
        min-width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
        background: white;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
      }

      th,
      td {
        padding: 15px 8px;
        text-align: left;
        border-bottom: 1px solid #ecf0f1;
        word-wrap: break-word;
        max-width: 0;
      }

      th {
        background: #34495e;
        color: white;
        font-weight: 600;
        position: sticky;
        top: 0;
        z-index: 10;
        white-space: nowrap;
      }

      td {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      tr:hover {
        background: #f8f9fa;
      }

      .module-detail {
        margin-bottom: 40px;
        width: 100%;
        max-width: 100%;
      }

      .module-title {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.3rem;
        text-align: center;
      }

      .module-content {
        display: flex;
        flex-direction: column;
        gap: 20px;
        width: 100%;
      }

      .module-table {
        width: 100%;
        order: 1;
      }

      .module-chart {
        width: 100%;
        order: 2;
        background: white;
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        height: 300px;
        max-width: 100%;
      }

      .timeline {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        margin-bottom: 30px;
        width: 100%;
      }

      .timeline h2 {
        color: #2c3e50;
        margin-bottom: 20px;
        font-size: 1.5rem;
        text-align: center;
      }

      .timeline-item {
        display: flex;
        align-items: flex-start;
        margin-bottom: 20px;
        padding: 15px;
        background: white;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        flex-direction: column;
        width: 100%;
      }

      .timeline-month {
        background: #3498db;
        color: white;
        padding: 10px 15px;
        border-radius: 25px;
        font-weight: 600;
        text-align: center;
        margin-bottom: 10px;
        align-self: flex-start;
      }

      .timeline-content {
        flex: 1;
        width: 100%;
      }

      .timeline-title {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 5px;
      }

      .timeline-desc {
        color: #7f8c8d;
        font-size: 0.9rem;
      }

      .footer {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        text-align: center;
        width: 100%;
      }

      .footer h3 {
        color: #2c3e50;
        margin-bottom: 10px;
      }

      .footer p {
        color: #7f8c8d;
      }

      /* MOBILE RESPONSIVE */
      @media (max-width: 768px) {
        body {
          overflow-x: hidden;
        }

        .container {
          padding: 10px;
          width: 100%;
          max-width: 100vw;
        }

        .header {
          padding: 20px 15px;
          margin-bottom: 20px;
          border-radius: 15px;
        }

        .header h1 {
          font-size: 1.8rem;
        }

        .header p {
          font-size: 1rem;
        }

        .summary-cards {
          grid-template-columns: 1fr 1fr;
          gap: 10px;
          margin-bottom: 20px;
        }

        .card {
          padding: 15px;
          border-radius: 10px;
        }

        .card h3 {
          font-size: 0.9rem;
        }

        .card .value {
          font-size: 1.5rem;
        }

        .chart-section {
          grid-template-columns: 1fr;
          gap: 15px;
          margin-bottom: 20px;
        }

        .chart-container {
          padding: 15px;
          margin-bottom: 15px;
          border-radius: 10px;
        }

        .chart-container h2 {
          font-size: 1.2rem;
          margin-bottom: 15px;
        }

        .chart-wrapper {
          height: 250px;
        }

        .table-section {
          padding: 15px;
          margin-bottom: 20px;
          border-radius: 10px;
        }

        .table-section h2 {
          font-size: 1.2rem;
        }

        .module-title {
          font-size: 1.1rem;
          margin-bottom: 10px;
        }

        .module-chart {
          height: 200px;
          padding: 10px;
        }

        .table-wrapper {
          border-radius: 8px;
        }

        table {
          font-size: 0.8rem;
          border-radius: 8px;
        }

        th,
        td {
          padding: 8px 6px;
          font-size: 0.8rem;
        }

        th {
          font-size: 0.75rem;
        }

        /* Hacer que las tablas se ajusten mejor */
        .module-table table {
          min-width: auto;
          width: 100%;
        }

        .module-table td,
        .module-table th {
          white-space: normal;
          word-break: break-word;
          min-width: 80px;
        }

        .module-table td:first-child,
        .module-table th:first-child {
          min-width: 120px;
        }

        .timeline {
          padding: 15px;
        }

        .timeline-item {
          padding: 10px;
        }

        .footer {
          padding: 15px;
        }
      }

      @media (max-width: 480px) {
        .container {
          padding: 8px;
        }

        .header {
          padding: 15px 10px;
        }

        .header h1 {
          font-size: 1.5rem;
        }

        .header p {
          font-size: 0.9rem;
        }

        .summary-cards {
          grid-template-columns: 1fr;
          gap: 8px;
        }

        .card .value {
          font-size: 1.3rem;
        }

        .chart-wrapper {
          height: 200px;
        }

        .module-chart {
          height: 180px;
          padding: 8px;
        }

        table {
          font-size: 0.7rem;
        }

        th,
        td {
          padding: 6px 4px;
          font-size: 0.7rem;
        }

        .module-table td:first-child,
        .module-table th:first-child {
          min-width: 100px;
        }

        .module-table td:last-child,
        .module-table th:last-child {
          min-width: 80px;
        }
      }

      /* DESKTOP RESPONSIVE */
      @media (min-width: 769px) {
        .module-content {
          flex-direction: row;
          align-items: flex-start;
        }

        .module-table {
          flex: 1;
          order: 1;
        }

        .module-chart {
          width: 400px;
          min-width: 400px;
          order: 2;
          height: 250px;
        }

        .timeline-item {
          flex-direction: row;
          align-items: center;
        }

        .timeline-month {
          margin-bottom: 0;
          margin-right: 20px;
          min-width: 80px;
        }

        .summary-cards {
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }
      }

      /* LANDSCAPE MOBILE */
      @media (max-width: 768px) and (orientation: landscape) {
        .chart-wrapper {
          height: 200px;
        }

        .module-chart {
          height: 150px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <div class="header">
        <h1>📚 Biblioteca Virtual</h1>
        <p>Análisis Completo de Costos</p>
      </div>

      <!-- Resumen General de Costos -->
      <div class="table-section">
        <h2>💼 Resumen General de Costos</h2>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Módulo</th>
                <th>Total (COP)</th>
                <th>%</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Frontend</strong></td>
                <td>$11,340,000</td>
                <td>38%</td>
              </tr>
              <tr>
                <td><strong>Backend</strong></td>
                <td>$10,000,000</td>
                <td>33%</td>
              </tr>
              <tr>
                <td><strong>Base de Datos</strong></td>
                <td>$3,150,000</td>
                <td>11%</td>
              </tr>
              <tr>
                <td><strong>Testing & QA</strong></td>
                <td>$3,000,000</td>
                <td>10%</td>
              </tr>
              <tr>
                <td><strong>Raspberry Pi</strong></td>
                <td>$1,900,000</td>
                <td>6%</td>
              </tr>
              <tr>
                <td><strong>Kit Hardware</strong></td>
                <td>$645,914</td>
                <td>2%</td>
              </tr>
              <tr style="background: #2c3e50; color: white; font-weight: bold">
                <td><strong>TOTAL</strong></td>
                <td><strong>$30,035,914</strong></td>
                <td><strong>100%</strong></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Summary Cards -->
      <div class="summary-cards">
        <div class="card">
          <h3>Presupuesto Total</h3>
          <div class="value">$30.0M</div>
          <div class="label">COP</div>
        </div>
        <div class="card">
          <h3>Duración</h3>
          <div class="value">6-8</div>
          <div class="label">Meses</div>
        </div>
        <div class="card">
          <h3>Módulos</h3>
          <div class="value">6</div>
          <div class="label">Componentes</div>
        </div>
        <div class="card">
          <h3>Horas Total</h3>
          <div class="value">780h+</div>
          <div class="label">Desarrollo</div>
        </div>
      </div>

      <!-- Charts Section -->
      <div class="chart-section">
        <!-- Distribución de Costos -->
        <div class="chart-container">
          <h2>💰 Distribución de Costos</h2>
          <div class="chart-wrapper">
            <canvas id="costChart"></canvas>
          </div>
        </div>

        <!-- Horas por Módulo -->
        <div class="chart-container">
          <h2>⏱️ Horas de Desarrollo</h2>
          <div class="chart-wrapper">
            <canvas id="hoursChart"></canvas>
          </div>
        </div>
      </div>

      <!-- Comparación Costos vs Horas -->
      <div class="chart-container">
        <h2>📊 Análisis: Costos vs Horas</h2>
        <div class="chart-wrapper">
          <canvas id="comparisonChart"></canvas>
        </div>
      </div>

      <!-- Desglose Detallado por Módulos -->
      <div class="table-section">
        <h2>📋 Desglose Detallado por Módulos</h2>

        <!-- Frontend Detalle -->
        <div class="module-detail">
          <h3 class="module-title" style="color: #3498db">
            🎨 Frontend Development (40%)
          </h3>
          <div class="module-content">
            <div class="module-table">
              <div class="table-wrapper">
                <table>
                  <thead>
                    <tr>
                      <th>Comp. Frontend</th>
                      <th>Subtotal</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Interfaz biblioteca</td>
                      <td>$4,200,000</td>
                    </tr>
                    <tr>
                      <td>Sistema multiidioma</td>
                      <td>$2,800,000</td>
                    </tr>
                    <tr>
                      <td>Responsive design</td>
                      <td>$2,100,000</td>
                    </tr>
                    <tr>
                      <td>Traductor señas</td>
                      <td>$1,400,000</td>
                    </tr>
                    <tr>
                      <td>Plataforma aprendizaje</td>
                      <td>$840,000</td>
                    </tr>
                    <tr
                      style="
                        background: #3498db;
                        color: white;
                        font-weight: bold;
                      "
                    >
                      <td><strong>TOTAL</strong></td>
                      <td><strong>$11,340,000</strong></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="module-chart">
              <canvas id="frontendChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Backend Detalle -->
        <div class="module-detail">
          <h3 class="module-title" style="color: #e74c3c">
            ⚙️ Backend Development (35%)
          </h3>
          <div class="module-content">
            <div class="module-table">
              <div class="table-wrapper">
                <table>
                  <thead>
                    <tr>
                      <th>Comp. Backend</th>
                      <th>Subtotal</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>API REST biblioteca</td>
                      <td>$4,000,000</td>
                    </tr>
                    <tr>
                      <td>Sistema autenticación</td>
                      <td>$1,600,000</td>
                    </tr>
                    <tr>
                      <td>Contenido multimedia</td>
                      <td>$2,400,000</td>
                    </tr>
                    <tr>
                      <td>Integración traductor</td>
                      <td>$1,200,000</td>
                    </tr>
                    <tr>
                      <td>Optimización performance</td>
                      <td>$800,000</td>
                    </tr>
                    <tr
                      style="
                        background: #e74c3c;
                        color: white;
                        font-weight: bold;
                      "
                    >
                      <td><strong>TOTAL</strong></td>
                      <td><strong>$10,000,000</strong></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="module-chart">
              <canvas id="backendChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Base de Datos Detalle -->
        <div class="module-detail">
          <h3 class="module-title" style="color: #2ecc71">
            🗄️ Base de Datos (11%)
          </h3>
          <div class="module-content">
            <div class="module-table">
              <div class="table-wrapper">
                <table>
                  <thead>
                    <tr>
                      <th>Comp. BD</th>
                      <th>Subtotal</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Diseño BD</td>
                      <td>$1,350,000</td>
                    </tr>
                    <tr>
                      <td>Implementación BD</td>
                      <td>$1,125,000</td>
                    </tr>
                    <tr>
                      <td>Optimización consultas</td>
                      <td>$675,000</td>
                    </tr>
                    <tr
                      style="
                        background: #2ecc71;
                        color: white;
                        font-weight: bold;
                      "
                    >
                      <td><strong>TOTAL</strong></td>
                      <td><strong>$3,150,000</strong></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="module-chart">
              <canvas id="databaseChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Testing Detalle -->
        <div class="module-detail">
          <h3 class="module-title" style="color: #f39c12">
            🧪 Testing y QA (10%)
          </h3>
          <div class="module-content">
            <div class="module-table">
              <div class="table-wrapper">
                <table>
                  <thead>
                    <tr>
                      <th>Comp. Testing</th>
                      <th>Subtotal</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Testing funcional</td>
                      <td>$1,200,000</td>
                    </tr>
                    <tr>
                      <td>Testing responsive</td>
                      <td>$750,000</td>
                    </tr>
                    <tr>
                      <td>Testing performance</td>
                      <td>$600,000</td>
                    </tr>
                    <tr>
                      <td>Testing seguridad</td>
                      <td>$450,000</td>
                    </tr>
                    <tr
                      style="
                        background: #f39c12;
                        color: white;
                        font-weight: bold;
                      "
                    >
                      <td><strong>TOTAL</strong></td>
                      <td><strong>$3,000,000</strong></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="module-chart">
              <canvas id="testingChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Raspberry Pi Detalle -->
        <div class="module-detail">
          <h3 class="module-title" style="color: #9b59b6">
            🖥️ Raspberry Pi (6%)
          </h3>
          <div class="module-content">
            <div class="module-table">
              <div class="table-wrapper">
                <table>
                  <thead>
                    <tr>
                      <th>Comp. Raspberry</th>
                      <th>Subtotal</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Setup servidor</td>
                      <td>$1,000,000</td>
                    </tr>
                    <tr>
                      <td>Config. seguridad</td>
                      <td>$500,000</td>
                    </tr>
                    <tr>
                      <td>Documentación</td>
                      <td>$400,000</td>
                    </tr>
                    <tr
                      style="
                        background: #9b59b6;
                        color: white;
                        font-weight: bold;
                      "
                    >
                      <td><strong>TOTAL</strong></td>
                      <td><strong>$1,900,000</strong></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="module-chart">
              <canvas id="raspberryChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Kit Hardware Detalle -->
        <div class="module-detail">
          <h3 class="module-title" style="color: #1abc9c">
            🛠️ Kit Hardware (2%)
          </h3>
          <div class="module-content">
            <div class="module-table">
              <div class="table-wrapper">
                <table>
                  <thead>
                    <tr>
                      <th>Hardware</th>
                      <th>Precio</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Raspberry Pi 5 8GB</td>
                      <td>$514,851</td>
                    </tr>
                    <tr>
                      <td>Cargador Pi</td>
                      <td>$35,910</td>
                    </tr>
                    <tr>
                      <td>Router Wifi</td>
                      <td>$95,153</td>
                    </tr>
                    <tr
                      style="
                        background: #1abc9c;
                        color: white;
                        font-weight: bold;
                      "
                    >
                      <td><strong>TOTAL</strong></td>
                      <td><strong>$645,914</strong></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="module-chart">
              <canvas id="hardwareChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Gráfica de Todos los Componentes -->
        <div style="margin-top: 30px">
          <h3
            style="
              color: #2c3e50;
              margin-bottom: 15px;
              font-size: 1.2rem;
              text-align: center;
            "
          >
            📊 Comparación: Todos los Componentes
          </h3>
          <div
            style="
              background: white;
              border-radius: 10px;
              padding: 15px;
              box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            "
          >
            <canvas
              id="allComponentsChart"
              style="height: 350px !important"
            ></canvas>
          </div>
        </div>
      </div>

      <!-- Características Técnicas -->
      <div class="table-section">
        <h2>🔧 Características Técnicas</h2>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Componente</th>
                <th>Tecnología</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Frontend</strong></td>
                <td>React.js + TypeScript</td>
              </tr>
              <tr>
                <td><strong>Backend</strong></td>
                <td>Node.js + Express</td>
              </tr>
              <tr>
                <td><strong>Base de Datos</strong></td>
                <td>PostgreSQL + MongoDB</td>
              </tr>
              <tr>
                <td><strong>Traductor Señas</strong></td>
                <td>SignAll API</td>
              </tr>
              <tr>
                <td><strong>Multiidioma</strong></td>
                <td>i18next</td>
              </tr>
              <tr>
                <td><strong>Servidor Local</strong></td>
                <td>Raspberry Pi 4</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script>
      // Configuración global de Chart.js
      Chart.defaults.responsive = true;
      Chart.defaults.maintainAspectRatio = false;

      window.addEventListener("load", function () {
        console.log("Iniciando carga de gráficas optimizadas para móvil...");

        if (typeof Chart === "undefined") {
          console.error("Chart.js no se cargó correctamente");
          return;
        }

        // Datos del proyecto
        const projectData = {
          modules: [
            "Frontend",
            "Backend",
            "Base de Datos",
            "Testing & QA",
            "Raspberry Pi",
            "Kit Hardware",
          ],
          costs: [11340000, 10000000, 3150000, 3000000, 1900000, 645914],
          hours: [324, 250, 70, 100, 38, 0],
          percentages: [38, 33, 11, 10, 6, 2],
        };

        const detailedData = {
          frontend: {
            labels: [
              "Interfaz biblioteca",
              "Sistema multiidioma",
              "Responsive design",
              "Traductor señas",
              "Plataforma aprendizaje",
            ],
            hours: [120, 80, 60, 40, 24],
            costs: [4200000, 2800000, 2100000, 1400000, 840000],
          },
          backend: {
            labels: [
              "API REST",
              "Autenticación",
              "Contenido multimedia",
              "Integración traductor",
              "Optimización performance",
            ],
            hours: [100, 40, 60, 30, 20],
            costs: [4000000, 1600000, 2400000, 1200000, 800000],
          },
          database: {
            labels: [
              "Diseño BD",
              "Implementación BD",
              "Optimización consultas",
            ],
            hours: [30, 25, 15],
            costs: [1350000, 1125000, 675000],
          },
          testing: {
            labels: [
              "Testing funcional",
              "Testing responsive",
              "Testing performance",
              "Testing seguridad",
            ],
            hours: [40, 25, 20, 15],
            costs: [1200000, 750000, 600000, 450000],
          },
          raspberry: {
            labels: [
              "Setup servidor",
              "Configuración seguridad",
              "Documentación técnica",
            ],
            hours: [20, 10, 8],
            costs: [1000000, 500000, 400000],
          },
          hardware: {
            labels: [
              "Raspberry Pi 5 8GB",
              "Cargador Raspberry Pi",
              "Router Wifi (opcional)",
            ],
            costs: [514851, 35910, 95153],
          },
        };

        const allComponents = {
          labels: [
            "Interfaz biblioteca",
            "API REST",
            "Gestión multimedia",
            "Sistema multiidioma",
            "Responsive design",
            "Autenticación",
            "Diseño BD",
            "Traductor señas",
            "Testing funcional",
            "Integración traductor",
            "Implementación BD",
            "Setup servidor",
            "Plataforma aprendizaje",
            "Optimización performance",
            "Testing responsive",
            "Optimización consultas",
            "Testing performance",
            "Raspberry Pi 5 8GB",
            "Configuración seguridad",
            "Testing seguridad",
            "Router Wifi",
            "Documentación técnica",
            "Cargador Raspberry Pi",
          ],
          costs: [
            4200000, 4000000, 2400000, 2800000, 2100000, 1600000, 1350000,
            1400000, 1200000, 1200000, 1125000, 1000000, 840000, 800000, 750000,
            675000, 600000, 514851, 500000, 450000, 95153, 400000, 35910,
          ],
          colors: [
            "#3498db",
            "#e74c3c",
            "#e74c3c",
            "#3498db",
            "#3498db",
            "#e74c3c",
            "#2ecc71",
            "#3498db",
            "#f39c12",
            "#e74c3c",
            "#2ecc71",
            "#9b59b6",
            "#3498db",
            "#e74c3c",
            "#f39c12",
            "#2ecc71",
            "#f39c12",
            "#1abc9c",
            "#9b59b6",
            "#f39c12",
            "#1abc9c",
            "#9b59b6",
            "#1abc9c",
          ],
        };

        const colors = [
          "#3498db",
          "#e74c3c",
          "#2ecc71",
          "#f39c12",
          "#9b59b6",
          "#1abc9c",
        ];

        // Función para detectar móvil
        const isMobile = () => window.innerWidth <= 768;

        // Opciones responsive
        const getResponsiveOptions = (baseOptions) => {
          const mobile = isMobile();
          return {
            ...baseOptions,
            plugins: {
              ...baseOptions.plugins,
              legend: {
                ...baseOptions.plugins?.legend,
                labels: {
                  ...baseOptions.plugins?.legend?.labels,
                  font: { size: mobile ? 9 : 12 },
                  padding: mobile ? 8 : 15,
                  boxWidth: mobile ? 12 : 15,
                },
              },
            },
            scales: baseOptions.scales
              ? {
                  ...baseOptions.scales,
                  x: baseOptions.scales.x
                    ? {
                        ...baseOptions.scales.x,
                        ticks: {
                          font: { size: mobile ? 8 : 11 },
                          maxRotation: mobile ? 45 : 0,
                        },
                      }
                    : undefined,
                  y: baseOptions.scales.y
                    ? {
                        ...baseOptions.scales.y,
                        ticks: { font: { size: mobile ? 8 : 11 } },
                      }
                    : undefined,
                  y1: baseOptions.scales.y1
                    ? {
                        ...baseOptions.scales.y1,
                        ticks: { font: { size: mobile ? 8 : 11 } },
                      }
                    : undefined,
                }
              : undefined,
          };
        };

        // 1. Gráfica de distribución de costos
        try {
          const costCtx = document.getElementById("costChart");
          if (costCtx) {
            new Chart(costCtx, {
              type: "doughnut",
              data: {
                labels: projectData.modules,
                datasets: [
                  {
                    data: projectData.costs,
                    backgroundColor: colors,
                    borderColor: "#ffffff",
                    borderWidth: 2,
                    hoverOffset: isMobile() ? 8 : 15,
                  },
                ],
              },
              options: getResponsiveOptions({
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: {
                    position: "bottom",
                    labels: {
                      usePointStyle: true,
                      generateLabels: function (chart) {
                        const data = chart.data;
                        return data.labels.map((label, i) => {
                          const percentage = projectData.percentages[i];
                          return {
                            text: `${label}: ${percentage}%`,
                            fillStyle: colors[i],
                            strokeStyle: colors[i],
                            lineWidth: 1,
                            hidden: false,
                            index: i,
                          };
                        });
                      },
                    },
                  },
                  tooltip: {
                    callbacks: {
                      label: function (context) {
                        const value = context.raw;
                        const percentage =
                          projectData.percentages[context.dataIndex];
                        return `${context.label}: ${(value / 1000000).toFixed(
                          1
                        )}M (${percentage}%)`;
                      },
                    },
                  },
                },
              }),
            });
          }
        } catch (error) {
          console.error("Error creando gráfica de costos:", error);
        }

        // 2. Gráfica de horas
        try {
          const hoursCtx = document.getElementById("hoursChart");
          if (hoursCtx) {
            const hoursData = projectData.hours.filter((h) => h > 0);
            const hoursLabels = projectData.modules.filter(
              (_, i) => projectData.hours[i] > 0
            );

            new Chart(hoursCtx, {
              type: "bar",
              data: {
                labels: hoursLabels,
                datasets: [
                  {
                    label: "Horas",
                    data: hoursData,
                    backgroundColor: colors.slice(0, 5),
                    borderColor: colors.slice(0, 5),
                    borderWidth: 1,
                    borderRadius: 4,
                  },
                ],
              },
              options: getResponsiveOptions({
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                  y: {
                    beginAtZero: true,
                    grid: { color: "rgba(0,0,0,0.1)" },
                    title: { display: !isMobile(), text: "Horas" },
                  },
                  x: {
                    grid: { display: false },
                  },
                },
                plugins: {
                  legend: { display: false },
                  tooltip: {
                    callbacks: {
                      label: function (context) {
                        return `${context.parsed.y} horas`;
                      },
                    },
                  },
                },
              }),
            });
          }
        } catch (error) {
          console.error("Error creando gráfica de horas:", error);
        }

        // 3. Gráfica de comparación
        try {
          const comparisonCtx = document.getElementById("comparisonChart");
          if (comparisonCtx) {
            const filteredModules = projectData.modules.filter(
              (_, i) => projectData.hours[i] > 0
            );
            const filteredCosts = projectData.costs
              .slice(0, 5)
              .map((c) => c / 1000000);
            const filteredHours = projectData.hours.slice(0, 5);

            new Chart(comparisonCtx, {
              type: "line",
              data: {
                labels: filteredModules,
                datasets: [
                  {
                    label: "Costo (M COP)",
                    data: filteredCosts,
                    borderColor: "#e74c3c",
                    backgroundColor: "rgba(231, 76, 60, 0.1)",
                    tension: 0.4,
                    fill: true,
                    yAxisID: "y",
                  },
                  {
                    label: "Horas",
                    data: filteredHours,
                    borderColor: "#3498db",
                    backgroundColor: "rgba(52, 152, 219, 0.1)",
                    tension: 0.4,
                    fill: true,
                    yAxisID: "y1",
                  },
                ],
              },
              options: getResponsiveOptions({
                responsive: true,
                maintainAspectRatio: false,
                interaction: { mode: "index", intersect: false },
                scales: {
                  y: {
                    type: "linear",
                    display: true,
                    position: "left",
                    title: { display: !isMobile(), text: "Costo (M)" },
                  },
                  y1: {
                    type: "linear",
                    display: true,
                    position: "right",
                    title: { display: !isMobile(), text: "Horas" },
                    grid: { drawOnChartArea: false },
                  },
                },
                plugins: { legend: { position: "bottom" } },
              }),
            });
          }
        } catch (error) {
          console.error("Error creando gráfica de comparación:", error);
        }

        // Función para crear gráficas de barras de módulos
        const createModuleBarChart = (canvasId, data, color) => {
          try {
            const ctx = document.getElementById(canvasId);
            if (ctx) {
              new Chart(ctx, {
                type: "bar",
                data: {
                  labels: data.labels,
                  datasets: [
                    {
                      data: data.costs.map((c) => c / 1000000),
                      backgroundColor: color,
                      borderColor: color,
                      borderWidth: 1,
                      borderRadius: 3,
                    },
                  ],
                },
                options: getResponsiveOptions({
                  responsive: true,
                  maintainAspectRatio: false,
                  indexAxis: isMobile() ? "x" : "y",
                  scales: {
                    x: {
                      beginAtZero: true,
                      title: { display: false },
                    },
                    y: {
                      beginAtZero: true,
                      title: { display: false },
                    },
                  },
                  plugins: {
                    legend: { display: false },
                    tooltip: {
                      callbacks: {
                        label: function (context) {
                          const hours = data.hours[context.dataIndex];
                          const cost = isMobile()
                            ? context.parsed.y
                            : context.parsed.x;
                          return `${cost.toFixed(1)}M (${hours}h)`;
                        },
                      },
                    },
                  },
                }),
              });
            }
          } catch (error) {
            console.error(`Error creando gráfica ${canvasId}:`, error);
          }
        };

        // Función para crear gráficas de dona
        const createModuleDoughnutChart = (canvasId, data, colors) => {
          try {
            const ctx = document.getElementById(canvasId);
            if (ctx) {
              new Chart(ctx, {
                type: "doughnut",
                data: {
                  labels: data.labels,
                  datasets: [
                    {
                      data: data.costs,
                      backgroundColor: colors,
                      borderColor: "#ffffff",
                      borderWidth: 1,
                    },
                  ],
                },
                options: getResponsiveOptions({
                  responsive: true,
                  maintainAspectRatio: false,
                  plugins: {
                    legend: { position: "bottom" },
                    tooltip: {
                      callbacks: {
                        label: function (context) {
                          const hours = data.hours
                            ? data.hours[context.dataIndex]
                            : "";
                          const hourText = hours ? ` (${hours}h)` : "";
                          return `${context.label}: ${(
                            context.raw / 1000000
                          ).toFixed(1)}M${hourText}`;
                        },
                      },
                    },
                  },
                }),
              });
            }
          } catch (error) {
            console.error(`Error creando gráfica ${canvasId}:`, error);
          }
        };

        // Crear gráficas de módulos
        createModuleBarChart("frontendChart", detailedData.frontend, "#3498db");
        createModuleBarChart("backendChart", detailedData.backend, "#e74c3c");
        createModuleDoughnutChart("databaseChart", detailedData.database, [
          "#2ecc71",
          "#27ae60",
          "#1e8449",
        ]);
        createModuleDoughnutChart("testingChart", detailedData.testing, [
          "#f39c12",
          "#e67e22",
          "#d68910",
          "#b7950b",
        ]);

        // Raspberry Pi
        try {
          const raspberryCtx = document.getElementById("raspberryChart");
          if (raspberryCtx) {
            new Chart(raspberryCtx, {
              type: "bar",
              data: {
                labels: detailedData.raspberry.labels,
                datasets: [
                  {
                    data: detailedData.raspberry.costs.map((c) => c / 1000000),
                    backgroundColor: ["#9b59b6", "#8e44ad", "#7d3c98"],
                    borderColor: ["#9b59b6", "#8e44ad", "#7d3c98"],
                    borderWidth: 1,
                    borderRadius: 3,
                  },
                ],
              },
              options: getResponsiveOptions({
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                  y: { beginAtZero: true, title: { display: false } },
                  x: { title: { display: false } },
                },
                plugins: {
                  legend: { display: false },
                  tooltip: {
                    callbacks: {
                      label: function (context) {
                        const hours =
                          detailedData.raspberry.hours[context.dataIndex];
                        return `${context.parsed.y.toFixed(1)}M (${hours}h)`;
                      },
                    },
                  },
                },
              }),
            });
          }
        } catch (error) {
          console.error("Error creando gráfica raspberry:", error);
        }

        // Hardware
        createModuleDoughnutChart(
          "hardwareChart",
          {
            labels: detailedData.hardware.labels,
            costs: detailedData.hardware.costs,
          },
          ["#1abc9c", "#16a085", "#138d75"]
        );

        // Gráfica de todos los componentes
        try {
          const allComponentsCtx =
            document.getElementById("allComponentsChart");
          if (allComponentsCtx) {
            new Chart(allComponentsCtx, {
              type: "bar",
              data: {
                labels: allComponents.labels,
                datasets: [
                  {
                    data: allComponents.costs.map((c) => c / 1000000),
                    backgroundColor: allComponents.colors,
                    borderColor: allComponents.colors,
                    borderWidth: 1,
                    borderRadius: 2,
                  },
                ],
              },
              options: getResponsiveOptions({
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: "y",
                scales: {
                  x: {
                    beginAtZero: true,
                    title: { display: !isMobile(), text: "Millones COP" },
                  },
                  y: {
                    ticks: { font: { size: isMobile() ? 7 : 9 } },
                  },
                },
                plugins: {
                  legend: { display: false },
                  tooltip: {
                    callbacks: {
                      label: function (context) {
                        return `${context.label}: ${context.parsed.x.toFixed(
                          1
                        )}M COP`;
                      },
                    },
                  },
                },
              }),
            });
          }
        } catch (error) {
          console.error(
            "Error creando gráfica de todos los componentes:",
            error
          );
        }

        console.log(
          "Todas las gráficas optimizadas para móvil han sido creadas"
        );

        // Redimensionar al cambiar orientación
        let resizeTimeout;
        window.addEventListener("resize", function () {
          clearTimeout(resizeTimeout);
          resizeTimeout = setTimeout(function () {
            Chart.helpers.each(Chart.instances, function (instance) {
              instance.resize();
            });
          }, 100);
        });
      });

      // Animaciones
      document.addEventListener("DOMContentLoaded", function () {
        const cards = document.querySelectorAll(".card");
        cards.forEach((card, index) => {
          card.style.opacity = "0";
          card.style.transform = "translateY(10px)";
          setTimeout(() => {
            card.style.transition = "all 0.4s ease";
            card.style.opacity = "1";
            card.style.transform = "translateY(0)";
          }, index * 50);
        });
      });
    </script>
  </body>
</html>
